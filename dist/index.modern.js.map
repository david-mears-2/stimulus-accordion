{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport './index.scss';\n\nexport default class extends Controller {\n  get togglers() {\n    return this.context.bindingObserver.bindings\n               .filter(binding => binding.action.methodName == 'toggle')\n               .map(binding => binding.action.element);\n  }\n\n  connect() {\n    this.enableTrans(false);\n    this.init();\n    setTimeout(() => this.enableTrans(true), 200);\n  }\n\n  enableTrans(enabled) {\n    this.element.classList.toggle('st-accordion--disable-trans', !enabled);\n  }\n\n  init() {\n    this.togglers.forEach(toggler => {\n      let content = this.findContent(toggler);\n      if (this.isOpened(toggler)) {\n        this.toggleClass(toggler, content, true);\n      } else {\n        this.toggleClass(toggler, content, false);\n      }\n    })\n  }\n\n  toggle(e) {\n    this.togglers.forEach(toggler => {\n      if (toggler == e.target) {\n        if (this.isOpened(toggler)) {\n          this.close(toggler);\n        } else {\n          this.open(toggler);\n        }\n      } else if (this.isOpened(toggler)) {\n        this.close(toggler);\n      }\n    });\n\n    e.preventDefault();\n  }\n\n  open(toggler) {\n    let content = this.findContent(toggler);\n    this.toggleClass(toggler, content, true);\n    this.dispatch('opened', { detail: { toggler: toggler, content: content } });\n  }\n\n  close(toggler) {\n    let content = this.findContent(toggler);\n    this.toggleClass(toggler, content, false);\n    this.dispatch('closed', { detail: { toggler: toggler, content: content } });\n  }\n\n  isOpened(toggler) {\n    return toggler.matches('.st-accordion__icon--opened');\n  }\n\n  toggleClass(toggler, content, opened) {\n    toggler.classList.toggle('st-accordion__icon--opened', opened);\n\n    content.classList.toggle('st-accordion__content--visible', opened);\n    content.style.height = (opened ? content.scrollHeight : 0) + 'px';\n\n    if (opened) {\n      let openedText = toggler.getAttribute('data-accordion-opened-text-param');\n      if (openedText) toggler.innerHTML = openedText;\n    } else {\n      let closedText = toggler.getAttribute('data-accordion-closed-text-param');\n      if (closedText) toggler.innerHTML = closedText;\n    }\n  }\n\n  findContent(target) {\n    let id = target.getAttribute('href').replace(/^#/, '');\n    return this.scope.findElement(`[data-accordion-id=\"${id}\"]`);\n  }\n}\n"],"names":["Controller","togglers","context","bindingObserver","bindings","filter","binding","action","methodName","map","element","connect","this","enableTrans","init","setTimeout","enabled","classList","toggle","forEach","toggler","content","findContent","isOpened","toggleClass","e","target","close","open","preventDefault","dispatch","detail","matches","opened","style","height","scrollHeight","openedText","getAttribute","innerHTML","closedText","id","replace","scope","findElement"],"mappings":"gEAG6BA,EACvBC,eACF,YAAYC,QAAQC,gBAAgBC,SACxBC,OAAOC,GAAwC,UAA7BA,EAAQC,OAAOC,YACjCC,IAAIH,GAAWA,EAAQC,OAAOG,SAG5CC,UACEC,KAAKC,aAAY,GACjBD,KAAKE,OACLC,WAAW,IAAMH,KAAKC,aAAY,GAAO,KAG3CA,YAAYG,GACVJ,KAAKF,QAAQO,UAAUC,OAAO,+BAAgCF,GAGhEF,OACEF,KAAKX,SAASkB,QAAQC,IACpB,IAAIC,EAAUT,KAAKU,YAAYF,GAC3BR,KAAKW,SAASH,GAChBR,KAAKY,YAAYJ,EAASC,GAAS,GAEnCT,KAAKY,YAAYJ,EAASC,GAAS,KAKzCH,OAAOO,GACLb,KAAKX,SAASkB,QAAQC,IAChBA,GAAWK,EAAEC,OACXd,KAAKW,SAASH,GAChBR,KAAKe,MAAMP,GAEXR,KAAKgB,KAAKR,GAEHR,KAAKW,SAASH,IACvBR,KAAKe,MAAMP,KAIfK,EAAEI,iBAGJD,KAAKR,GACH,IAAIC,EAAUT,KAAKU,YAAYF,GAC/BR,KAAKY,YAAYJ,EAASC,GAAS,GACnCT,KAAKkB,SAAS,SAAU,CAAEC,OAAQ,CAAEX,QAASA,EAASC,QAASA,KAGjEM,MAAMP,GACJ,IAAIC,EAAUT,KAAKU,YAAYF,GAC/BR,KAAKY,YAAYJ,EAASC,GAAS,GACnCT,KAAKkB,SAAS,SAAU,CAAEC,OAAQ,CAAEX,QAASA,EAASC,QAASA,KAGjEE,SAASH,GACP,OAAOA,EAAQY,QAAQ,+BAGzBR,YAAYJ,EAASC,EAASY,GAM5B,GALAb,EAAQH,UAAUC,OAAO,6BAA8Be,GAEvDZ,EAAQJ,UAAUC,OAAO,iCAAkCe,GAC3DZ,EAAQa,MAAMC,QAAUF,EAASZ,EAAQe,aAAe,GAAK,KAEzDH,EAAQ,CACV,IAAII,EAAajB,EAAQkB,aAAa,oCAClCD,IAAYjB,EAAQmB,UAAYF,OAC/B,CACL,IAAIG,EAAapB,EAAQkB,aAAa,oCAClCE,IAAYpB,EAAQmB,UAAYC,IAIxClB,YAAYI,GACV,IAAIe,EAAKf,EAAOY,aAAa,QAAQI,QAAQ,KAAM,IACnD,YAAYC,MAAMC,YAAa,uBAAsBH"}