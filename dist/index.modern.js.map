{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport './index.scss';\n\nexport default class extends Controller {\n  get togglers() {\n    return this.context.bindingObserver.bindings\n               .filter(binding => binding.action.methodName == 'toggle')\n               .map(binding => binding.action.element);\n  }\n\n  connect() {\n    this.enableTrans(false);\n    this.init();\n    setTimeout(() => this.enableTrans(true), 200);\n  }\n\n  enableTrans(enabled) {\n    if (enabled) {\n      this.element.classList.add('st-accordion--disable-trans');\n    } else {\n      this.element.classList.remove('st-accordion--disable-trans');\n    }\n  }\n\n  init() {\n    this.togglers.forEach(toggler => {\n      let content = this.findContent(toggler);\n      if (this.isOpened(toggler)) {\n        this.toggleClass(toggler, content, true);\n      } else {\n        this.toggleClass(toggler, content, false);\n      }\n    })\n  }\n\n  toggle(e) {\n    this.togglers.forEach(toggler => {\n      if (toggler == e.target) {\n        if (this.isOpened(toggler)) {\n          this.close(toggler);\n        } else {\n          this.open(toggler);\n        }\n      } else if (this.isOpened(toggler)) {\n        this.close(toggler);\n      }\n    });\n\n    e.preventDefault();\n  }\n\n  open(toggler) {\n    let content = this.findContent(toggler);\n    this.toggleClass(toggler, content, true);\n    this.dispatch('opened', { detail: { toggler: toggler, content: content } });\n  }\n\n  close(toggler) {\n    let content = this.findContent(toggler);\n    this.toggleClass(toggler, content, false);\n    this.dispatch('closed', { detail: { toggler: toggler, content: content } });\n  }\n\n  isOpened(toggler) {\n    return toggler.matches('.st-accordion__icon--opened');\n  }\n\n  toggleClass(toggler, content, opened) {\n    if (opened) {\n      toggler.classList.add('st-accordion__icon--opened');\n      content.classList.add('st-accordion__content--visible');\n      content.style.height = content.scrollHeight + 'px';\n    } else {\n      toggler.classList.remove('st-accordion__icon--opened');\n      content.classList.remove('st-accordion__content--visible');\n      content.style.height = '0px';\n    }\n\n    if (opened) {\n      let openedText = toggler.getAttribute('data-accordion-opened-text-param');\n      if (openedText) toggler.innerHTML = openedText;\n    } else {\n      let closedText = toggler.getAttribute('data-accordion-closed-text-param');\n      if (closedText) toggler.innerHTML = closedText;\n    }\n  }\n\n  findContent(target) {\n    let id = target.getAttribute('href').replace(/^#/, '');\n    return this.scope.findElement(`[data-accordion-id=\"${id}\"]`);\n  }\n}\n"],"names":["Controller","togglers","context","bindingObserver","bindings","filter","binding","action","methodName","map","element","connect","this","enableTrans","init","setTimeout","enabled","classList","add","remove","forEach","toggler","content","findContent","isOpened","toggleClass","toggle","e","target","close","open","preventDefault","dispatch","detail","matches","opened","style","height","scrollHeight","openedText","getAttribute","innerHTML","closedText","id","replace","scope","findElement"],"mappings":"gEAG6BA,EACvBC,eACF,YAAYC,QAAQC,gBAAgBC,SACxBC,OAAOC,GAAwC,UAA7BA,EAAQC,OAAOC,YACjCC,IAAIH,GAAWA,EAAQC,OAAOG,SAG5CC,UACEC,KAAKC,aAAY,GACjBD,KAAKE,OACLC,WAAW,IAAMH,KAAKC,aAAY,GAAO,KAG3CA,YAAYG,GACNA,EACFJ,KAAKF,QAAQO,UAAUC,IAAI,+BAE3BN,KAAKF,QAAQO,UAAUE,OAAO,+BAIlCL,OACEF,KAAKX,SAASmB,QAAQC,IACpB,IAAIC,EAAUV,KAAKW,YAAYF,GAC3BT,KAAKY,SAASH,GAChBT,KAAKa,YAAYJ,EAASC,GAAS,GAEnCV,KAAKa,YAAYJ,EAASC,GAAS,KAKzCI,OAAOC,GACLf,KAAKX,SAASmB,QAAQC,IAChBA,GAAWM,EAAEC,OACXhB,KAAKY,SAASH,GAChBT,KAAKiB,MAAMR,GAEXT,KAAKkB,KAAKT,GAEHT,KAAKY,SAASH,IACvBT,KAAKiB,MAAMR,KAIfM,EAAEI,iBAGJD,KAAKT,GACH,IAAIC,EAAUV,KAAKW,YAAYF,GAC/BT,KAAKa,YAAYJ,EAASC,GAAS,GACnCV,KAAKoB,SAAS,SAAU,CAAEC,OAAQ,CAAEZ,QAASA,EAASC,QAASA,KAGjEO,MAAMR,GACJ,IAAIC,EAAUV,KAAKW,YAAYF,GAC/BT,KAAKa,YAAYJ,EAASC,GAAS,GACnCV,KAAKoB,SAAS,SAAU,CAAEC,OAAQ,CAAEZ,QAASA,EAASC,QAASA,KAGjEE,SAASH,GACP,OAAOA,EAAQa,QAAQ,+BAGzBT,YAAYJ,EAASC,EAASa,GAW5B,GAVIA,GACFd,EAAQJ,UAAUC,IAAI,8BACtBI,EAAQL,UAAUC,IAAI,kCACtBI,EAAQc,MAAMC,OAASf,EAAQgB,aAAe,OAE9CjB,EAAQJ,UAAUE,OAAO,8BACzBG,EAAQL,UAAUE,OAAO,kCACzBG,EAAQc,MAAMC,OAAS,OAGrBF,EAAQ,CACV,IAAII,EAAalB,EAAQmB,aAAa,oCAClCD,IAAYlB,EAAQoB,UAAYF,OAC/B,CACL,IAAIG,EAAarB,EAAQmB,aAAa,oCAClCE,IAAYrB,EAAQoB,UAAYC,IAIxCnB,YAAYK,GACV,IAAIe,EAAKf,EAAOY,aAAa,QAAQI,QAAQ,KAAM,IACnD,YAAYC,MAAMC,YAAa,uBAAsBH"}